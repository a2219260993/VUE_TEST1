<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="vue.js"></script>
    <link rel="stylesheet" href="sty.css">
</head>

<body>
    <div id="app">
        <div class="bigBox">
            <div class="list">
                <ul class="top">
                    <li></li>
                    <li @click="sort('date')">Date <span v-if="ishort">&and;</span><span v-if="!ishort">&or;</span></li>
                    <li>#</li>
                    <li>Description</li>
                    <li>Total</li>
                </ul>
                <ul :key="itme.id" class="data-list" v-for="itme in showpage">
                    <li @click="showRound(itme)">
                        <div class="round" v-if="itme.show"></div>
                    </li>
                    <li>{{itme.date}}</li>
                    <li>{{itme.no}}</li>
                    <li>{{itme.data}}</li>
                    <li>{{itme.total}}</li>
                </ul>
            </div>
            <!-- 分页和搜索 -->
            <div class="search">
                <!-- 分页 -->
                <div class="search-fy">
                    <a class="choose" href="" @click.prevent='uppage()'>
                        &lt; </a>

                    <a href="" v-for='itme in pageSize' :class="[itme==nowpage?'choose':'']"
                        @click.prevent='choose(itme)'>{{itme}}</a>
                    <a class="choose" href="" @click.prevent='nextpage()'>
                        &gt;
                    </a>
                </div>
                <input type="text" placeholder="Search" class="search-input" v-model='searchdate'>
            </div>
        </div>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                //向上排序还是向下排序
                // ishort 是true的时候是向上排序
                // ishort 是 false 的时候是向下排序

                ishort: true,
                //排序状态
                shortType: null,
                //总数据
                list: [{
                    key: 1,
                    show: false,
                    date: '10/1/2017',
                    no: '000001',
                    data: 'Alpha Bravo Charlie',
                    total: '26.00'
                }, {
                    key: 2,
                    show: false,
                    date: '10/3/2017',
                    no: '000002',
                    data: 'Alpha Bravo Charlie',
                    total: '26.00'
                }, {
                    key: 3,
                    show: false,
                    date: '11/31/2017',
                    no: '000011',
                    data: 'Alpha 1231 Charlie',
                    total: '26.00'
                }, {
                    key: 4,
                    show: false,
                    date: '5/31/2017',
                    no: '000011',
                    data: 'Alpha Bravo 61asd',
                    total: '26.00'
                }, {
                    key: 5,
                    show: false,
                    date: '10/31/2019',
                    no: '000011',
                    data: '168s Bravo Charlie',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2020',
                    no: '006433',
                    data: 'Alpha Bravo gasd',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2017',
                    no: '000011',
                    data: 'Alpha Bravo sasd',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2017',
                    no: '000011',
                    data: 'asd Bravo Charlie',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2017',
                    no: '554066',
                    data: 'Alpha ggg Charlie',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2017',
                    no: '13597',
                    data: 'Alpha dasd Charlie',
                    total: '26.00'
                }, {
                    key: 6,
                    show: false,
                    date: '10/31/2017',
                    no: '000011',
                    data: 'liuzhouyu chao ji bang',
                    total: '26.00'
                }],

                //当前页码
                nowpage: 1,
                // searchlist: [],
                searchdate: ''

            },
            methods: {
                cmp: function (type) {
                    let that = this;
                    return function (a, b) {
                        // console.log(type)
                        let x = a[type].split('/');
                        let y = b[type].split('/');
                        //将时间转换为标准时间格式
                        let date1 = new Date(x[2] + ',' + x[0] + ',' + x[1]);
                        let date2 = new Date(y[2] + ',' + y[0] + ',' + y[1]);
                        //！that.ishort是代表转换后的  当你现在是升序 你点一下是变成降序
                        // 如果要得到自己想要的结果， 不管是升序还是降序， 就需要提供比较函数了。 该函数比较两个值的大小， 然后返回一个用于说明这两个值的相对顺序的数字。
                        // 比较函数应该具有两个参数 a 和 b， 其返回值如下：
                        // 若 a 小于 b， 即 a - b 小于零， 则返回一个小于零的值， 数组将按照升序排列。
                        // 若 a 等于 b， 则返回 0。
                        // 若 a 大于 b, 即 a - b 大于零， 则返回一个大于零的值， 数组将按照降序排列
                        if (!that.ishort) {
                            return date1 - date2;
                            //date1>date2 升序
                        } else {
                            return date2 - date1;
                            // date2>date1 降序
                        }
                    }
                },
                sort: function (type) {
                    this.showpage.sort(this.cmp(type))
                    // console.log(type);
                    this.ishort = !this.ishort;
                },
                //小圆点的显示与隐藏
                showRound: function (el) {
                    console.log(el);
                    el.show = !el.show
                },
                //点击页码
                choose: function (itme) {
                    this.nowpage = itme;
                },
                uppage: function () {
                    if (this.nowpage === 1) {
                        this.nowpage = this.pageSize;
                    } else {
                        this.nowpage--;
                    }
                },
                nextpage() {
                    if (this.nowpage === this.pageSize) {
                        this.nowpage = 1;
                    } else {
                        this.nowpage++;
                    }
                }
            },
            computed: {
                //计算应该分多少页
                pageSize: function () {
                    // console.log(this.list.length / 6);
                    return Math.ceil(this.searchlist.length / 6) || 1;
                    // math.ceil是求整数
                },
                // 用来存放搜索的数据
                searchlist: function () {
                    var that = this;
                    var slist = [];
                    // 基本方法选择：
                    // for (var i = 0; i < this.list.length; i++) {
                    //     //for循环数据中的每一项（根据name值）
                    //     if (this.list[i].no.search(this.searchdate) != -1 || this.list[i].data.search(this
                    //             .searchdate) != -1) {
                    //         //判断输入框中的值是否可以匹配到数据，如果匹配成功
                    //         slist.push(this.list[i]);
                    //         //向空数组中添加数据
                    //     }
                    // }
                    // 利用filter（）
                    slist = this.list.filter(function (x) {
                        if (x.no.search(that.searchdate) != -1 || x.data
                            .search(that
                                .searchdate) != -1) {
                            return true;
                        } else {
                            return false;
                        }
                    })
                    return slist;
                },
                //计算某一页存放的数据
                showpage: function () {
                    return this.searchlist.slice((this.nowpage - 1) * 6, this.nowpage * 6)
                }

            }
        })
    </script>



</body>


</html>